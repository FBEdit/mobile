html, body {
  margin: 0;
  padding: 0;
  background: #000;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  touch-action: none;
  position: fixed;
  inset: 0;
}
#container {
  position: fixed;
  left: 0; top: 0; width: 100vw; height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  z-index: 1;
}
#game {
  display: block;
  background: #111;
  image-rendering: pixelated;
  touch-action: none;
  max-width: 100vw;
  max-height: 100vh;
  width: 100vw;
  height: 100vh;
  position: relative;
  z-index: 2;
}
.aspect-4-3 #game {
  width: 100vw;
  height: calc(100vw * 0.75);
  max-width: 100vw;
  max-height: 100vh;
}
@media (min-aspect-ratio: 4/3) {
  .aspect-4-3 #game {
    width: calc(100vh * 4 / 3);
    height: 100vh;
    max-width: 100vw;
    max-height: 100vh;
  }
}

#joystick, #pad {
  position: fixed;
  z-index: 10;
  user-select: none;
  touch-action: none;
}
#joystick {
  left: var(--joy-left, 2vw);
  bottom: 2vw;
  width: var(--joy-size, 16vw);
  height: var(--joy-size, 16vw);
  min-width: 70px;
  min-height: 70px;
  max-width: 120px;
  max-height: 120px;
  background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.01) 70%, rgba(255,255,255,0.13) 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 16px #000b;
  pointer-events: none;
}
#stick {
  width: var(--thumb-size, 6vw);
  height: var(--thumb-size, 6vw);
  min-width: 32px;
  min-height: 32px;
  max-width: 60px;
  max-height: 60px;
  background: radial-gradient(circle at 40% 40%, #fff 70%, #bbb 100%);
  border-radius: 50%;
  box-shadow: 0 0 16px #8889, 0 4px 16px #222a;
  border: 2.5px solid #00fa5a;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  transition: left 0.04s linear, top 0.04s linear;
  pointer-events: auto;
  touch-action: none;
}

#pad {
  left: var(--joy-left, 2vw);
  bottom: 2vw;
  width: var(--pad-size, 16vw);
  height: var(--pad-size, 16vw);
  min-width: 90px;
  min-height: 90px;
  max-width: 130px;
  max-height: 130px;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-template-rows: 1fr 1fr 1fr;
  gap: 0;
  pointer-events: none;
  background: none;
}

.pad-btn {
  background: linear-gradient(180deg, #222 60%, #111 100%);
  border-radius: 18%;
  box-shadow: 0 0 8px #2223, 0 1px 2px #fff1 inset;
  border: 2.5px solid #00b3c7;
  width: 100%;
  height: 100%;
  font-size: 2vw;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.94;
  pointer-events: auto;
  user-select: none;
  touch-action: none;
  outline: none;
  transition: background 0.08s, border 0.10s, transform 0.07s;
  filter: brightness(1.10);
}
.pad-btn.pressed, .pad-btn:active {
  background: linear-gradient(180deg, #05ff9e 70%, #00b3c7 100%);
  color: #111;
  border-color: #fff;
  filter: brightness(1.3) saturate(1.2);
  transform: scale(1.07);
}
.pad-btn[tabindex] { outline: none; }

#escBtn, #rBtn {
  position: fixed;
  width: var(--btn-width, 12vw);
  height: var(--btn-height, 7vw);
  min-width: 52px;
  min-height: 32px;
  max-width: 90px;
  max-height: 60px;
  font-size: 2.6vw;
  font-family: inherit;
  border: none;
  border-radius: 1.2vw;
  background: linear-gradient(180deg, #191c2b 0%, #0d1117 100%);
  color: #fff;
  z-index: 20;
  opacity: 0.98;
  box-shadow: 0 4px 18px #0e0b, 0 1px 8px #00b3c7;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: right 0.15s, left 0.15s, background 0.08s, box-shadow 0.13s, color 0.10s, transform 0.07s;
  user-select: none;
  touch-action: none;
  font-weight: 700;
  border: 2.5px solid #00b3c7;
  letter-spacing: 0.03em;
}
#escBtn {
  top: 2vw;
  right: var(--btn-right, 2vw);
  left: var(--btn-left, auto);
}
#rBtn {
  top: calc(2vw + var(--btn-vgap, 10vw));
  right: var(--btn-right, 2vw);
  left: var(--btn-left, auto);
}
.btn-left #escBtn, .btn-left #rBtn {
  right: auto;
  left: var(--btn-left, 2vw);
}
#escBtn:active, #rBtn:active, #escBtn.pressed, #rBtn.pressed {
  background: linear-gradient(180deg, #00b3c7 70%, #05ff9e 100%);
  color: #222;
  box-shadow: 0 2px 16px #00b3c7cc;
  transform: scale(1.07);
}
#escBtn {
  border-color: #e93e3a;
}
#escBtn:active, #escBtn.pressed {
  background: linear-gradient(180deg, #ff5151 70%, #e93e3a 100%);
  color: #fff;
  box-shadow: 0 2px 16px #e93e3a99;
}
#rBtn {
  border-color: #ffde03;
}
#rBtn:active, #rBtn.pressed {
  background: linear-gradient(180deg, #ffde03 70%, #f7b32b 100%);
  color: #111;
  box-shadow: 0 2px 16px #ffde0399;
}
@media (orientation: portrait) {
  #container { width: 100vw; height: 100vh; }
  #game { width: 100vw; height: 100vw; max-height: 100vw; }
  #joystick, #pad { left: var(--joy-left, 2vw); bottom: 2vw; }
  #escBtn, #rBtn { right: var(--btn-right, 2vw); left: var(--btn-left, auto);}
}
* { -webkit-tap-highlight-color: transparent; }
body, #joystick, #pad, .pad-btn, #escBtn, #rBtn { touch-action: none; }