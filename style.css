html, body {
  margin: 0;
  padding: 0;
  background: #000;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  touch-action: none;
  position: fixed;
  inset: 0;
}
#game {
  display: block;
  background: #111;
  image-rendering: pixelated;
  touch-action: none;
  width: 100vw;
  height: 100vh;
  position: absolute;
  left: 0; top: 0;
  max-width: 100vw;
  max-height: 100vh;
  z-index: 2;
}
.aspect-4-3 #game {
  left: 50%;
  top: 50%;
  width: 100vw;
  height: calc(100vw * 0.75);
  max-width: 100vw;
  max-height: 100vh;
  transform: translate(-50%, -50%);
}
@media (min-aspect-ratio: 4/3) {
  .aspect-4-3 #game {
    width: calc(100vh * 4 / 3);
    height: 100vh;
    max-width: 100vw;
    max-height: 100vh;
  }
}
#joystick, #pad {
  position: fixed;
  z-index: 10;
  user-select: none;
  touch-action: none;
  pointer-events: none;
}
#joystick {
  left: var(--joy-left, 2vw);
  bottom: 2vw;
  width: var(--joy-size, 18vw);
  height: var(--joy-size, 18vw);
  min-width: 70px;
  min-height: 70px;
  max-width: 150px;
  max-height: 150px;
  background: rgba(255,255,255,0.10);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 1vw #222;
  pointer-events: auto;
}
#stick {
  width: var(--thumb-size, 7vw);
  height: var(--thumb-size, 7vw);
  min-width: 30px;
  min-height: 30px;
  max-width: 70px;
  max-height: 70px;
  background: radial-gradient(circle at 60% 40%, #fff 65%, #bbb 100%);
  border-radius: 50%;
  box-shadow: 0 0 2vw #888;
  border: 2px solid #fff;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  transition: left 0.04s linear, top 0.04s linear;
  pointer-events: none;
}
#pad {
  left: var(--joy-left, 2vw);
  bottom: 2vw;
  width: var(--pad-size, 18vw);
  height: var(--pad-size, 18vw);
  min-width: 90px;
  min-height: 90px;
  max-width: 160px;
  max-height: 160px;
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-template-rows: 1fr 1fr 1fr;
  gap: 0;
  pointer-events: none;
}
.pad-btn {
  background: rgba(255,255,255,0.14);
  border-radius: 17%;
  box-shadow: 0 0 1vw #222;
  border: none;
  width: 100%;
  height: 100%;
  font-size: 2.3vw;
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.92;
  user-select: none;
  touch-action: none;
  outline: none;
  transition: background 0.08s;
  pointer-events: auto;
}
.pad-btn.pressed {
  background: #0f0;
  color: #000;
}
.pad-btn:active { background: #0d0; }
.pad-btn[tabindex] { outline: none; }
#escBtn, #rBtn {
  position: fixed;
  width: var(--btn-width, 12vw);
  height: var(--btn-height, 8vw);
  min-width: 50px;
  min-height: 32px;
  max-width: 100px;
  max-height: 70px;
  font-size: 3vw;
  font-family: inherit;
  border: none;
  border-radius: 1.2vw;
  background: linear-gradient(180deg, #0f0 80%, #222 100%);
  color: #111;
  z-index: 20;
  opacity: 0.97;
  box-shadow: 0 0 1vw #111;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: right 0.15s, left 0.15s;
  user-select: none;
  touch-action: none;
}
#escBtn {
  top: 2vw;
  right: var(--btn-right, 2vw);
  left: var(--btn-left, auto);
}
#rBtn {
  top: calc(2vw + var(--btn-vgap, 11vw));
  right: var(--btn-right, 2vw);
  left: var(--btn-left, auto);
}
.btn-left #escBtn, .btn-left #rBtn {
  right: auto;
  left: var(--btn-left, 2vw);
}
#escBtn:active, #rBtn:active {
  background: linear-gradient(180deg, #fff 85%, #0f0 100%);
  color: #0b0;
}
@media (orientation: portrait) {
  #game { width: 100vw; height: 100vw; max-height: 100vw; }
  #joystick, #pad { left: var(--joy-left, 2vw); bottom: 2vw; }
  #escBtn, #rBtn { right: var(--btn-right, 2vw); left: var(--btn-left, auto);}
}
* { -webkit-tap-highlight-color: transparent; }
body, #joystick, #pad, .pad-btn, #escBtn, #rBtn { touch-action: none; }